

## 名词

VPN
VPC
VPS



以pptp vpn协议为例说明。
假设要访问谷歌，那么客户端发出的数据包首先通过协议栈处理封装成IP包，其源地址是
虚拟网卡的地址，例如：192.168.0.2，而目标地址是谷歌的IP。
原始IP包交给虚拟网卡发送时，PPTP网卡驱动会按PPP协议对这个IP包整体加密封装作为
新的payload，用一层新的IP头封装这个payload发送出去，这个新IP头的目标地址是vpn s
erver，源地址是客户端的外网IP。
vpn server的协议栈会剥离掉新IP头，将内部PPP协议的payload交给pptpd进程处理，pp
tpd进程会按PPP协议解包得到原始的IP包，我们知道这个IP包的源地址是192.168.0.2，目
标地址google。因此，pptpd进程需要做的是将这个IP包的源IP地址改为vps的地址，然后
将IP包发给谷歌，从而和谷歌进行数据交换。最终，pptpd理所应当将谷歌的应答IP包的目
标IP地址换成192.168.0.2，然后经过PPP协议封装并添加新的IP头后发回给客户端既可。
不过要注意在pptpd的实现里，这个源地址修改是通过iptables实现的，也就是添加通过ip
tables添加一个NAT规则，实现来源地址的映射转换，这个在你配置pptp的过程中就会看
到

- 参考 https://yuerblog.cc/2017/01/03/how-vpn-works-and-how-to-setup-pptp/


vpn是通过编写一套网卡驱动并注册到操作系统实vpn比ss更加底层，它通过操作系统的接口直接虚拟出一张网卡，后续整个操作系统的网
络通讯都将通过这张虚拟的网卡进行收发。这和任何一个代理的实现思路都差不多，应用
层并不知道网卡是虚拟的，这样vpn虚拟网卡将以中间人的身份对数据进行加工，从而实
现各种神奇的效果。具体来说，vpn是通过编写一套网卡驱动并注册到操作系统实现的虚
拟网卡，这样数据只要经过网卡收发就可以进行拦截处理。


## VPC与VPN有什么关系


## 什么是隧道？
路由直通吗？


## VPN如何保障通信的私密性？



## VPN怎么做到的隧道，怎样把两台主机的路由直接连起来的？

VPN工作在IP层，直接篡改路由，实现VPN客户端与服务端直接路由连接。 -- by xs

## 相关法律
国家法律已有规定：未经电信主管部门批准, 不得自行建立或租用专线(含虚拟专用网络 VPN)等其他信道开展**跨境经营活动**。如果有人利用VPN技术提供互联网跨境访问的，就触犯了法律。像阿里云、腾讯云之类的云服务商虽然也提供VPN服务，但并不提供Internet访问。(阿里云主机能访问google吗？不提供Internet访问是什么意思？)
