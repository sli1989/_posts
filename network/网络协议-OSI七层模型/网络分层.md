---
title: 网络分层
date: 2018-02-23
tags:
categories:
- net
- osi
---

## Overview




## 基本概念


<table border="1" cellspacing="0" class="MsoTable15Grid5DarkAccent1" style="border-collapse:collapse; border:solid white 1.0pt; width:100.0%">
	<tbody>
		<tr>
			<td style="background-color:#5b9bd5; width:2.06%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left">&nbsp;</p>
			</td>
			<td style="background-color:#5b9bd5; width:13.58%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif"><strong><span style="font-family:宋体"><span style="color:white">数据单元</span></span><span style="color:white">/</span></strong><strong><span style="font-family:宋体"><span style="color:white">格式</span></span></strong></span></span></p>
			</td>
			<td style="background-color:#5b9bd5; width:6.2%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif"><strong><span style="color:white">TCP/IP</span></strong><strong><span style="font-family:宋体"><span style="color:white">层</span></span></strong></span></span></p>
			</td>
			<td style="background-color:#5b9bd5; width:8.8%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif"><strong><span style="color:white">OSI</span></strong><strong><span style="font-family:宋体"><span style="color:white">层</span></span></strong></span></span></p>
			</td>
			<td style="background-color:#5b9bd5; width:38.54%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif"><strong><span style="font-family:宋体"><span style="color:white">功能</span></span></strong></span></span></p>
			</td>
			<td style="background-color:#5b9bd5; width:13.94%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif"><strong><span style="color:white">TCP/IP</span></strong><strong><span style="font-family:宋体"><span style="color:white">协议族</span></span></strong></span></span></p>
			</td>
			<td style="background-color:#5b9bd5; width:16.88%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif"><strong><span style="font-family:宋体"><span style="color:white">典型设备</span></span></strong></span></span></p>
			</td>
		</tr>
		<tr>
			<td rowspan="4" style="background-color:#5b9bd5; width:2.06%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:center"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif"><strong><span style="font-family:宋体"><span style="color:white">主机层</span></span></strong></span></span></p>
			</td>
			<td rowspan="3" style="background-color:#bdd6ee; width:13.58%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif">Data(<span style="font-family:宋体">数据</span>)</span></span></p>
			</td>
			<td rowspan="3" style="background-color:#bdd6ee; width:6.2%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif"><span style="font-family:宋体">应用层</span></span></span></p>
			</td>
			<td style="background-color:#bdd6ee; width:8.8%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif">7. <span style="font-family:宋体">应用层</span> Application</span></span></p>
			</td>
			<td style="background-color:#bdd6ee; width:38.54%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif"><span style="font-family:宋体">网络进程到应用程序。针对特定应用规定各层协议、时序、表示等，进行封装。在端系统中用软件来实现，如</span>HTTP<span style="font-family:宋体">等</span></span></span></p>
			</td>
			<td style="background-color:#bdd6ee; width:13.94%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif">DHCP<span style="font-family:宋体">、</span>Telnet<span style="font-family:宋体">、</span>FTP<span style="font-family:宋体">、</span>HTTP<span style="font-family:宋体">、</span>SNMP<span style="font-family:宋体">、</span>DNS</span></span></p>
			</td>
			<td style="background-color:#bdd6ee; width:16.88%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif"><span style="font-family:宋体">网关</span></span></span></p>
			</td>
		</tr>
		<tr>
			<td style="background-color:#deeaf6; width:8.8%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif">6. <span style="font-family:宋体">表示层</span> Presentation</span></span></p>
			</td>
			<td style="background-color:#deeaf6; width:38.54%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif"><span style="font-family:宋体">数据表示形式，加密和解密，把机器相关的数据转换成独立于机器的数据。规定数据的格式化表示，数据格式的转换等</span></span></span></p>
			</td>
			<td style="background-color:#deeaf6; width:13.94%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left">&nbsp;</p>
			</td>
			<td style="background-color:#deeaf6; width:16.88%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left">&nbsp;</p>
			</td>
		</tr>
		<tr>
			<td style="background-color:#bdd6ee; width:8.8%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif">5. <span style="font-family:宋体">会话层</span> Session</span></span></p>
			</td>
			<td style="background-color:#bdd6ee; width:38.54%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif"><span style="font-family:宋体">主机间通讯，管理应用程序之间的会话。规定通信时序；数据交换的定界、同步，创建检查点等</span></span></span></p>
			</td>
			<td style="background-color:#bdd6ee; width:13.94%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left">&nbsp;</p>
			</td>
			<td style="background-color:#bdd6ee; width:16.88%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left">&nbsp;</p>
			</td>
		</tr>
		<tr>
			<td style="background-color:#deeaf6; width:13.58%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif">Segments(<span style="font-family:宋体">数据段</span>)</span></span></p>
			</td>
			<td style="background-color:#deeaf6; width:6.2%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif"><span style="font-family:宋体">传输层</span></span></span></p>
			</td>
			<td style="background-color:#deeaf6; width:8.8%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif">4. <span style="font-family:宋体">传输层</span> Transport</span></span></p>
			</td>
			<td style="background-color:#deeaf6; width:38.54%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif"><span style="font-family:宋体">在网络的各个节点之间可靠的分发数据包。所有传输遗留问题；复用；流量控制；可靠</span></span></span></p>
			</td>
			<td style="background-color:#deeaf6; width:13.94%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif">TCP UDP TLS/SSL</span></span></p>
			</td>
			<td style="background-color:#deeaf6; width:16.88%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left">&nbsp;</p>
			</td>
		</tr>
		<tr>
			<td rowspan="3" style="background-color:#5b9bd5; height:13.15pt; width:2.06%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:center"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif"><strong><span style="font-family:宋体"><span style="color:white">媒介层</span></span></strong></span></span></p>
			</td>
			<td style="background-color:#bdd6ee; height:13.15pt; width:13.58%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif">Datagram(<span style="font-family:宋体">分组</span>/<span style="font-family:宋体">数据报文</span>)<span style="font-family:宋体">数据包</span>(packet</span></span></p>
			</td>
			<td style="background-color:#bdd6ee; height:13.15pt; width:6.2%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif"><span style="font-family:宋体">网络层</span> Internet</span></span></p>
			</td>
			<td style="background-color:#bdd6ee; height:13.15pt; width:8.8%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif">3. <span style="font-family:宋体">网络层</span> Network</span></span></p>
			</td>
			<td style="background-color:#bdd6ee; height:13.15pt; width:38.54%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif"><span style="font-family:宋体">在网络的各个节点之间进行地址分配、路由和</span>(<span style="font-family:宋体">不一定可靠的</span>)<span style="font-family:宋体">分发报文。路由</span>(IP<span style="font-family:宋体">寻址</span>)<span style="font-family:宋体">；拥塞控制</span></span></span></p>

			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif"><span style="font-family:宋体">分割和重新组合数据包</span></span></span></p>
			</td>
			<td style="background-color:#bdd6ee; height:13.15pt; width:13.94%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif">IP ICMP BGP RIP</span></span></p>
			</td>
			<td style="background-color:#bdd6ee; height:13.15pt; width:16.88%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif"><span style="font-family:宋体">路由器</span></span></span></p>
			</td>
		</tr>
		<tr>
			<td style="background-color:#deeaf6; width:13.58%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif">Bit/Frame(<span style="font-family:宋体">数据帧</span>)</span></span></p>

			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif"><span style="font-family:宋体">将</span>bit<span style="font-family:宋体">信息封装成数据帧</span>Frame</span></span></p>
			</td>
			<td rowspan="2" style="background-color:#deeaf6; width:6.2%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif"><span style="font-family:宋体">链路层</span></span></span></p>
			</td>
			<td style="background-color:#deeaf6; width:8.8%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif">2. <span style="font-family:宋体">数据链路层</span> DataLink</span></span></p>
			</td>
			<td style="background-color:#deeaf6; width:38.54%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif"><span style="font-family:宋体">一个可靠的点对点数据直链。检错与纠错</span>(CRC<span style="font-family:宋体">码</span>)<span style="font-family:宋体">；多路访问；寻址</span></span></span></p>
			</td>
			<td style="background-color:#deeaf6; width:13.94%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif">WiFi ARP</span></span></p>
			</td>
			<td style="background-color:#deeaf6; width:16.88%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif"><span style="font-family:宋体">交换机、网桥、网卡</span></span></span></p>
			</td>
		</tr>
		<tr>
			<td style="background-color:#bdd6ee; width:13.58%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif">Bit(<span style="font-family:宋体">比特</span>/<span style="font-family:宋体">比特流</span>)</span></span></p>
			</td>
			<td style="background-color:#bdd6ee; width:8.8%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif">1. <span style="font-family:宋体">物理层</span> Physical</span></span></p>
			</td>
			<td style="background-color:#bdd6ee; width:38.54%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif"><span style="font-family:宋体">一个</span>(<span style="font-family:宋体">不一定可靠的</span>)<span style="font-family:宋体">点对点数据直链。定义机械特性；电气特性；功能特性；过程特性</span></span></span></p>
			</td>
			<td style="background-color:#bdd6ee; width:13.94%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left">&nbsp;</p>
			</td>
			<td style="background-color:#bdd6ee; width:16.88%">
			<p style="margin-left:0cm; margin-right:0cm; text-align:left"><span style="font-size:10.5pt"><span style="font-family:Calibri,sans-serif"><span style="font-family:宋体">调制解调器、中继器、集线器、同轴电缆、双绞线</span></span></span></p>
			</td>
		</tr>
	</tbody>
</table>





## 各种分层


- [OSI模型-wikipedia](https://zh.wikipedia.org/wiki/OSI模型) 不全，还有很多常用网络协议未列出来
- [网络传输协议-wikipedia](https://zh.wikipedia.org/wiki/网络传输协议) 比OSI少了物理层

https://en.wikipedia.org/wiki/Internet_protocol_suite


[Overview of TCP/IP Protocol](https://www.novell.com/documentation/nw65/ntwk_ipv4_nw/data/hbnuubtt.html)
<image src="https://github.com/xsung/raw/raw/master/TCP%20IP%20-%204LayerModel%20-%20novell.com.gif">



## [Architectural Overview of the TCP/IP Protocol Suite](https://technet.microsoft.com/en-us/library/bb726993.aspx)
<image src="https://github.com/xsung/raw/raw/master/TCP%20IP%20-%20architecture%20-%20Microsoft.gif
">






## Overview of TCP/IP protocols,摘自《Unix网络编程 chapter2》
<image src="https://github.com/xsung/raw/raw/master/TCP%20IP%20-%20overview%20-%20unix%20network%20programing.gif">

## 七层 应用层

应用层（Application Layer）提供为应用软件而设的界面，以设置与另一应用软件之间的通信。
针对某个特定的用户应用程序（FTP、Telnet等）
比如
- HTTP Client与HTTP Server通信。
- DNS client与DNS Server通信。

## 六层 表示层

表示层（Presentation Layer）把数据转换为能与接收者的系统格式兼容并适合传输的格式。

## 五层 会话层

会话层（Session Layer）负责在数据传输中设置和维护电脑网络中两台电脑之间的通信连接。

## 四层 传输层
传输层（Transport Layer）把传输表头（TH）加至数据以形成数据包。传输表头包含了所使用的协议等发送信息。例如:传输控制协议（TCP）等。


## 三层 网络层


在计算机网络中进行通信的两个计算机之间可能会经过很多个数据链路，也可能还要经过很多通信子网。网络层的任务就是选择合适的网间路由和交换结点，确保数据及时传送。网络层将解封数据链路层收到的帧，提取数据包，包中封装有网络层包头，其中含有逻辑地址信息- -源站点和目的站点地址的网络地址。


数据的路径选择(分组的`选路`)、转发，将网络表头（NH）加至数据包，以形成分组。网络表头包含了网络数据。例如:互联网协议（IP）等。

### 寻址
路由器`根据IP地址进行寻址`，通过路由表路由协议产生

对网络层而言使用IP地址来唯一标识互联网上的设备，网络层依靠IP地址进行相互通信。

### 路由/转发
在同一个网络中的内部通信并不需要网络层设备，仅仅靠数据链路层就可以完成相互通信，对于不同的网络之间相互通信则必须借助路由器等三层设备。

数据包的转发，`不在同一个局域网`，他们彼此之间是不认识的，那么就不得不通过其他媒介，寻找到适当的方式才可以传输数据。

## 二层 链路层

二层`交换`，只能解决`同一个局域网`(彼此认识，mac地址)内的数据交换。


`物理地址寻址`、数据的成帧、流量控制、数据的检错、重发等

网络层（Network Layer）决定数据的路径选择和转寄，将网络表头（NH）加至数据包，以形成分组。网络表头包含了网络数据。例如:互联网协议（IP）等。

设备驱动程序及接口卡

交换机`根据MAC地址寻址`，通过站表选择路由，站表的建立和维护由交换机自动进行

## 一层 物理层

物理层（Physical Layer）在局部局域网上传送帧，它负责管理电脑通信设备和网络媒体之间的互通。包括了针脚、电压、线缆规范、集线器、中继器、网卡、主机适配器等

## 疑问

**为什么要平行层通信？**
因为其它层看不懂该协议。(其他协议看不懂)
**VPN算在哪个层？算网路协议吗？**
按道理应该算协议，客户端和服务端都要遵守的约定。应该算在应用层吧。--by xs

vpn在IP层工作，而ss在TCP层工作

**proxy**算在哪个层？
应用层吧，至少socket之上

**html5提出的websocket协议**
属于应用层


## 待看/其他参考
[所有的网络请求底层协议是不是都是TCP/IP？](https://www.zhihu.com/question/38517040)
[ss](https://uploadfiles.nowcoder.net/images/20170810/1767727_1502362836481_1CFEC006B29CBAEA6AFED26AB43D16A7)
